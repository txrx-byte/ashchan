# Ashchan Media/Uploads Service Configuration
# mTLS ServiceMesh Environment

# ─────────────────────────────────────────────────────────────
# Service Identity
# ─────────────────────────────────────────────────────────────
APP_NAME=media-uploads
APP_ENV=local
SERVICE_NAME=media
SERVICE_DNS_NAME=media.ashchan.local

# ─────────────────────────────────────────────────────────────
# Server Configuration
# ─────────────────────────────────────────────────────────────
# HTTP port (development only)
HTTP_PORT=9504

# Internal mTLS port (service-to-service)
MTLS_PORT=8446

# ─────────────────────────────────────────────────────────────
# mTLS Configuration (Service-to-Service)
# ─────────────────────────────────────────────────────────────
MTLS_ENABLED=true
MTLS_CERT_FILE=__PROJECT_ROOT__/certs/services/media/media.crt
MTLS_KEY_FILE=__PROJECT_ROOT__/certs/services/media/media.key
MTLS_CA_FILE=__PROJECT_ROOT__/certs/ca/ca.crt
MTLS_VERIFY_PEER=true
MTLS_MIN_TLS_VERSION=TLSv1.3

# Client certificates for outbound calls
MTLS_CLIENT_CERT_FILE=__PROJECT_ROOT__/certs/services/media/media.crt
MTLS_CLIENT_KEY_FILE=__PROJECT_ROOT__/certs/services/media/media.key

# ─────────────────────────────────────────────────────────────
# Database (PostgreSQL)
# ─────────────────────────────────────────────────────────────
DB_DRIVER=pgsql
DB_HOST=__DB_HOST__
DB_PORT=5432
DB_DATABASE=ashchan
DB_USERNAME=ashchan
DB_PASSWORD=ashchan
DB_CHARSET=utf8
DB_POOL_SIZE=10

# ─────────────────────────────────────────────────────────────
# Redis (Cache, Queue)
# ─────────────────────────────────────────────────────────────
REDIS_HOST=__REDIS_HOST__
REDIS_PORT=6379
REDIS_PASSWORD=__REDIS_PASSWORD__
REDIS_AUTH=__REDIS_AUTH__
REDIS_DB=3
REDIS_POOL_SIZE=10

# ─────────────────────────────────────────────────────────────
# Object Storage (MinIO/S3)
# ─────────────────────────────────────────────────────────────
MINIO_ENDPOINT=minio.ashchan.local:9000
MINIO_ACCESS_KEY=ashchan
MINIO_SECRET_KEY=ashchan123
MINIO_BUCKET=ashchan-media
MINIO_USE_SSL=false

# ─────────────────────────────────────────────────────────────
# Upload Configuration
# ─────────────────────────────────────────────────────────────
MAX_FILE_SIZE=10485760
MAX_IMAGE_SIZE=5242880
MAX_VIDEO_SIZE=10485760
ALLOWED_MIME_TYPES=image/jpeg,image/png,image/gif,image/webp,video/mp4,video/webm

# ─────────────────────────────────────────────────────────────
# Image Processing
# ─────────────────────────────────────────────────────────────
THUMBNAIL_WIDTH=250
THUMBNAIL_HEIGHT=250
THUMBNAIL_QUALITY=85

# ─────────────────────────────────────────────────────────────
# Event Bus (Redis Streams)
# ─────────────────────────────────────────────────────────────
# Publishes domain events (media.ingested) to Redis Streams
EVENTS_STREAM_NAME=ashchan:events
EVENTS_DLQ_STREAM=ashchan:events:dlq
EVENTS_MAXLEN=100000
EVENTS_REDIS_DB=6

# ─────────────────────────────────────────────────────────────
# Media Processing Queue
# ─────────────────────────────────────────────────────────────
MEDIA_QUEUE_NAME=media-processing
MEDIA_QUEUE_TIMEOUT=300

# ─────────────────────────────────────────────────────────────
# Logging
# ─────────────────────────────────────────────────────────────
LOG_LEVEL=info
LOG_FORMAT=json

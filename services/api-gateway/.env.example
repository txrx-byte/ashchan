# Ashchan API Gateway Configuration
# mTLS ServiceMesh Environment

# ─────────────────────────────────────────────────────────────
# Service Identity
# ─────────────────────────────────────────────────────────────
APP_NAME=api-gateway
APP_ENV=local
SERVICE_NAME=gateway
SERVICE_DNS_NAME=gateway.ashchan.local

# ─────────────────────────────────────────────────────────────
# Server Configuration
# ─────────────────────────────────────────────────────────────
# Public HTTP port (client-facing)
HTTP_PORT=9501

# Public HTTPS port (optional, for TLS termination)
HTTPS_PORT=9443

# Internal mTLS port (service-to-service)
MTLS_PORT=8443

# ─────────────────────────────────────────────────────────────
# mTLS Configuration (Service-to-Service)
# ─────────────────────────────────────────────────────────────
MTLS_ENABLED=true
MTLS_CERT_FILE=/etc/mtls/gateway/gateway.crt
MTLS_KEY_FILE=/etc/mtls/gateway/gateway.key
MTLS_CA_FILE=/etc/mtls/ca/ca.crt
MTLS_VERIFY_PEER=true
MTLS_MIN_TLS_VERSION=TLSv1.3

# ─────────────────────────────────────────────────────────────
# Database (PostgreSQL)
# ─────────────────────────────────────────────────────────────
DB_DRIVER=pgsql
DB_HOST=postgres.ashchan.local
DB_PORT=5432
DB_DATABASE=ashchan
DB_USERNAME=ashchan
DB_PASSWORD=ashchan
DB_CHARSET=utf8
DB_POOL_SIZE=10

# ─────────────────────────────────────────────────────────────
# Redis (Cache, Queue, Pub/Sub)
# ─────────────────────────────────────────────────────────────
REDIS_HOST=redis.ashchan.local
REDIS_PORT=6379
REDIS_PASSWORD=null
REDIS_DB=0
REDIS_POOL_SIZE=10

# ─────────────────────────────────────────────────────────────
# Backend Service URLs (mTLS)
# ─────────────────────────────────────────────────────────────
# All internal service communication uses mTLS on port 8443

AUTH_SERVICE_URL=https://auth.ashchan.local:8443
BOARDS_SERVICE_URL=https://boards.ashchan.local:8443
MEDIA_SERVICE_URL=https://media.ashchan.local:8443
SEARCH_SERVICE_URL=https://search.ashchan.local:8443
MODERATION_SERVICE_URL=https://moderation.ashchan.local:8443

# ─────────────────────────────────────────────────────────────
# Object Storage (MinIO/S3)
# ─────────────────────────────────────────────────────────────
MINIO_ENDPOINT=minio.ashchan.local:9000
MINIO_ACCESS_KEY=ashchan
MINIO_SECRET_KEY=ashchan123
MINIO_BUCKET=ashchan-media
MINIO_USE_SSL=false

# ─────────────────────────────────────────────────────────────
# CORS (Public API)
# ─────────────────────────────────────────────────────────────
CORS_ORIGINS=*
CORS_METHODS=GET,POST,PUT,DELETE,PATCH,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Request-ID

# ─────────────────────────────────────────────────────────────
# Rate Limiting
# ─────────────────────────────────────────────────────────────
RATE_LIMIT_ENABLED=true
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_WINDOW=60

# ─────────────────────────────────────────────────────────────
# Logging
# ─────────────────────────────────────────────────────────────
LOG_LEVEL=info
LOG_FORMAT=json

# ─────────────────────────────────────────────────────────────
# WebSocket (Live Updates)
# ─────────────────────────────────────────────────────────────
WEBSOCKET_ENABLED=true
WEBSOCKET_PORT=9501

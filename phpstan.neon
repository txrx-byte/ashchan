parameters:
    level: 10
    
    # All services to analyze
    paths:
        - services/api-gateway/app
        - services/api-gateway/config
        - services/auth-accounts/app
        - services/auth-accounts/config
        - services/boards-threads-posts/app
        - services/boards-threads-posts/config
        - services/media-uploads/app
        - services/media-uploads/config
        - services/moderation-anti-spam/app
        - services/moderation-anti-spam/config
        - services/search-indexing/app
        - services/search-indexing/config
        - db/migrations
        - db/seeders
        - setup_admin.php
    
    # Exclude template files that start with HTML
    excludePaths:
        - services/api-gateway/views/*
        - */vendor/*
        - */runtime/*
        - */storage/*
    
    # Comprehensive strictness rules for PHPStan 10
    checkMissingIterableValueType: true
    checkGenericClassInNonGenericObjectType: true
    reportUnmatchedIgnoredErrors: false
    treatPhpDocTypesAsCertain: false
    checkAlwaysTrueCheckTypeFunctionCall: true
    checkAlwaysTrueInstanceof: true
    checkAlwaysTrueStrictComparison: true
    checkExplicitMixedMissingReturn: true
    checkFunctionNameCase: true
    checkInternalClassCaseSensitivity: true
    checkMissingCallableSignature: true
    checkTooWideReturnTypesInProtectedAndPublicMethods: true
    checkUninitializedProperties: true
    checkDynamicProperties: true
    
    # Ignore common framework patterns that are safe
    ignoreErrors:
        # Hyperf framework patterns
        - '#Static call to instance method Hyperf\DbConnection\Db::.*#'
        - '#Static call to instance method Hyperf\HttpServer\Router\Router::.*#'
        - '#Method Hyperf\\HttpServer\\Contract\\ResponseInterface::json\(\) invoked with 2 parameters, 1 required\.#'
        - '#Cannot cast mixed to (int|float|string)\.#'
        - '#Function now not found\.#'
        
        # Dependency Injection patterns
        - '#Property .* is never written, only read\.#'
        - '#Property .* is never read, only written\.#'
        
        # Future-use constants
        - '#Constant .* is unused\.#'
        
        # Response methods available at runtime
        - '#Call to an undefined method Hyperf\\HttpServer\\Contract\\ResponseInterface::withStatus\(\)\.#'
        - '#Cannot call method withHeader\(\) on mixed\.#'
        
        # Generic types (framework patterns)
        - '#missingType\.generics#'
        - '#missingType\.iterableValue#'
        
        # Mixed type issues from framework ORM
        - '#Cannot call method .* on mixed\.#'
        - '#Access to an undefined property object::.*#'
        - '#Call to an undefined method object::.*#'
        - '#Cannot access offset .* on mixed\.#'
        - '#Argument of an invalid type mixed supplied for foreach#'
        - '#Possibly invalid array key type mixed\.#'
        
        # Return type issues from mixed input
        - '#Part \$.*\(mixed\) of encapsed string cannot be cast to string\.#'
        - '#Return type of call to method .* contains unresolvable type\.#'
        - '#Parameter .* \$callback of method .* contains unresolvable type\.#'
